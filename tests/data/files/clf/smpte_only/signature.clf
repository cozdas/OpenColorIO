<?xml version="1.0" encoding="UTF-8"?>
<ProcessList
    xmlns="http://www.smpte-ra.org/ns/2136-1/2024"
    xmlns:ds="http://www.w3.org/2000/09/xmldsig#"
    id="pl1"
    name="Example 1D LUT with XMLDSIG 1.1">

  <Description>Example CLF file with an enveloped XML Signature (XMLDSIG 1.1).</Description>
  <Description>OCIO does not support signatures yet, but it should not prevent reading the file.</Description>

  <!-- Minimal ProcessNode: LUT1D -->
  <LUT1D id="lut1" name="ExampleLUT1D" inBitDepth="16f" outBitDepth="16f">
    <Description>A tiny sample RGB LUT1D.</Description>
    <Array dim="3 3">0 0 0 0.3 0.4 0.5 1 1 1</Array>
  </LUT1D>

  <!-- Signer is ds:KeyInfoType (keying / cert info) -->
  <Signer>
    <ds:KeyName>Example Signing Key</ds:KeyName>
    <ds:X509Data>
      <!-- Placeholder base64 for an X.509 certificate (replace with a real cert) -->
      <ds:X509Certificate>MIIB...BASE64...CERT...==</ds:X509Certificate>
    </ds:X509Data>
  </Signer>

  <!-- Enveloped XML Signature over the ProcessList element (id="pl1") -->
  <ds:Signature Id="sig1">
    <ds:SignedInfo>
      <!-- Canonicalize SignedInfo using Canonical XML 1.1 -->
      <ds:CanonicalizationMethod Algorithm="http://www.w3.org/2006/12/xml-c14n11"/>
      <!-- Example signature algorithm: RSA-SHA256 -->
      <ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/>

      <!-- Reference the ProcessList element by same-document URI -->
      <ds:Reference URI="#pl1">
        <ds:Transforms>
          <!-- Remove the Signature element itself from what gets digested (enveloped signature) -->
          <ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
          <!-- (Recommended) Explicitly canonicalize the referenced node-set -->
          <ds:Transform Algorithm="http://www.w3.org/2006/12/xml-c14n11"/>
        </ds:Transforms>

        <!-- Digest with SHA-256 -->
        <ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/>
        <!-- Placeholder: replace with real base64 digest of transformed referenced data -->
        <ds:DigestValue>AA==</ds:DigestValue>
      </ds:Reference>
    </ds:SignedInfo>

    <!-- Placeholder: replace with real base64 signature over canonicalized SignedInfo -->
    <ds:SignatureValue>AA==</ds:SignatureValue>

    <!-- Optional KeyInfo inside the Signature (can repeat or reference the Signer info) -->
    <ds:KeyInfo>
      <ds:KeyName>Example Signing Key</ds:KeyName>
    </ds:KeyInfo>
  </ds:Signature>

</ProcessList>
